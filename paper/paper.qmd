---
title: "Education Serves as a Deterrent to Criminal Behaviour"
author: Rahma Binth Mohammad
thanks: "Code and data are available at: <https://github.com/rahmabinth/education>"
date: 16 February 2024
date-format: long
abstract: "This paper explores the impact of Compulsory School Leaving (CSL) reforms on criminal behaviour, focusing on their role in reducing crime rates, particularly among the youth demographic. Drawing upon empirical evidence, it investigates how CSL reforms incentivize educational attainment, thereby diminishing the allure of criminal activities. The study underscores the significance of education in deterring individuals from a life of crime and advocates for continued research to inform effective policy interventions."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(palmerpenguins)
library(haven)
library(ggplot2)
library(dplyr)
library(sf)
library(gridExtra)
library(patchwork)

```

```{r}
#| echo: false
#| warning: false
#| message: false

# Loading the data
figure1_data <- read_csv(here::here("data/raw_data/reproduction_data/figure1_data.csv"))
maps_d <- read_csv(here::here("data/raw_data/reproduction_data/maps_d.csv")) 
maps_d_clean <- read_csv(here::here("data/analysis_data/maps_d_clean.csv"))
dropout_age <- read_csv(here::here("data/raw_data/reproduction_data/dropout_age.csv"))

figure3_data <- read_csv(here::here("data/raw_data/reproduction_data/figure3_data.csv"))

```

# Introduction

This reproduction was performed after a replication on the Social Science Reproduction platform: <https://doi.org/10.48152/ssrp-2jxv-qj51>

In the United States, there is legal variation among states. While there are federal laws that apply to the country as a whole, education is at the purview of state governments. Thus, each state can choose to be progressive or conservative and traditional. Compulsory School Leaving (CSL) laws mandate children to attend school to a certain age, we will refer to this as the dropout age. They also create exemptions under certain extreme circumstances and certain states require parental consent. These laws are often reformed as time goes by to accommodate the changing society and norms. They represent a critical juncture in educational policy, with far-reaching implications for societal well-being and crime reduction. By mandating extended periods of schooling, these reforms aim to not only enhance educational attainment but also mitigate the prevalence of criminal behaviour, particularly among vulnerable youth populations. In recent years, a growing body of empirical research has shed light on the intricate relationship between education and crime, highlighting the profound impact that educational opportunities can have on shaping individual behaviour and societal outcomes. 

Brian Bell, Rui Costa, and Stephen Machin's paper, "Why Does Education Reduce Crime?,” examines the reasons behind the observed crime reductions, resulting from state-level dropout age reforms enacted between 1980 and 2010 in the United States. It provides an empirical framework to analyse the mechanisms driving these reductions, highlighting both short-term incapacitation effects and longer-term sustained crime-reducing effects generated by the reforms. Rather than focusing on education improvements, the study finds that the observed crime reduction is primarily attributed to dynamic incapacitation, shedding new light on the impact of dropout age reforms on criminal behaviour. The framework uses data from arrests at the county-level and extrapolates it into the state-level. It uses the data from dropout age reforms at the state-level to highlight the differences before and after the reforms come into effect in each state. 

In the following paper, we use the initial analysis from the above paper to produce a reproduction. This paper uses the data provided from the original paper’s replication package to study how effective CSL reforms are in promoting education, and the reasons behind the efficacy of educational interventions in reducing criminal behaviour and enhancing societal well-being. This paper argues that CSL reforms have the ability to keep individuals in school, giving them ample opportunity in society, once they graduate. It improves their socioeconomic standing, and discourages them from committing crimes. We find that these reforms to the laws directly result in a decrease of crimes, specifically violent, or drug-related crimes. 

Data for this analysis and the different applications used, will be introduced in @sec-data. @sec-results provides results from that analysis and @sec-discussion consists of a discussion of the results including the analysis’s weaknesses and biases. 

# Data {#sec-data}

## Sources
This paper replicates and explores various aspects of the original study for this analysis. It is reproduced using several data sets from the replication package provided with the paper “Why Does Education Reduce Crime?” [@education]. The replication package only holds the cleaned data in multiple files, depending on how they appear on the paper. Figures 1, 2, and 3 are replicated from the original paper for this reproduction. Our reproduction aims to address the following two questions: (1) Do CSL reforms deter individuals from criminal activity, and thus decreasing crime rate in youth? (2) Does this reduction reshape criminal behaviour distributions by age?

@education do not analyse a single dataset. Instead, we have many different sources provided to us. The ones used to reproduce and compile this paper are as follows:

- Federal Bureau of Investigation Uniform Crime Data [@fbi_ucr]
- Westlaw International Database [@westlaw]

### Arrest Data

`figure1_data.csv`

This dataset contains data for male arrest rate at the county level, calculated from years 2000 to 2010. There’s an arrest rate for every age for young adults (15-39) and each of three crime types. The crime types include violent crimes, property crimes, and drug crimes. 

`figure3_data.csv`

This dataset contains the mean of the arrest rate prior to a discontinuity in the arrests after a reform was enforced and discontinuity estimates by age calculated by Bell et al. Note that Texas (1985) is excluded from the estimation given that it showed a decrease in dropout age. 

### Reform Data

`dropout_age.csv`

The dropout age for each of the states in the country during the years 1980 and 2010 in one dataset. The authors of the original paper stated they had analysed each states reforms in regards to the education required attendance to record in this dataset [@education].

### United States Shapefiles

`maps_d.csv`

The centerpoint of each state according to the longitude and latitude of its location was provided in the dataset, along with the specific state identification number. 

`maps_c.csv`

The borders for each states according to the longitude and latitude of its location was provided in the dataset, along with the specific state identification number.

In general, these data sets provide us with a way to graph the arrest rates against the age for various crime type, compare the change in dropout ages as time passes, and see arrest rates prior and post to the reforms. We have omitted an in-depth examination of the discontinuity estimates for conciseness.

## Methodology
The language and environment used for this analysis is `R` [@citeR], alongside the `tidyverse` [@tidyverse], `dplyr` [@dplyr], `haven` [@haven], `ggplot2` [@ggplot2], and `sf` [@sf] packages. 

We downloaded, cleaned, and wrote csv files to make it R friendly. We have classified it into three categories, arrest data, reform data, and United States shapefiles. There are many more datasets in the package, but we chose to only focus on these three. An explanation of these choices will be given in @sec-results.

# Results {#sec-results}

In this paper, we have replicated the results found by the authors [@education] to convey the following important findings. CSL reforms causes reductions in criminal activity and reshape criminal behaviour distributions by age. 

```{r}
#| echo: false
#| label: fig-arrests
#| warning: false
#| fig-cap: US male arrest rates between the ages 15-24 from FBI Uniform Crime Reporting data

# Calculate cumulative_arrest for the male arrests per 1000 population
figure1_data <- figure1_data %>%
  group_by(agegroup, crime_type) %>%
  summarise(cumulative_arrest = sum(arrest_rate) * 1000) %>%
  ungroup()

# Reorder levels of crime_type, starting with the violent crimes on the bottom
figure1_data <- figure1_data %>%
  mutate(crime_type = factor(crime_type, levels = c(3, 2, 1)))

#Plots age against cumulative arrests
ggplot(figure1_data, aes(x = as.factor(agegroup), y = cumulative_arrest, 
                       fill = factor(crime_type))) +
  geom_bar(stat = "identity", position = "stack", width = 0.8) + #bar graph
  scale_fill_manual(values = c("black", "lightblue", "darkred"), #colours
                    labels = c("Drugs", "Property", "Violent")) + #legend
  labs(x = "Age", y = "Arrest Rate (Per 1000 Population)", fill = NULL, 
       title = "Cumalitive Arrests By Age and Crime Type") + #titles
  scale_x_discrete(labels = c("15", "16", "17", "18", "19", "20", "21", "22", 
                              "23", "24", "25-29", "30-34", "35-39")) + #labels
  scale_y_continuous(breaks = seq(0, 100, by = 20)) + # y-axis breaks
  theme_minimal() +
  theme(legend.position = "bottom", #legend position
        axis.text.x = element_text(angle = 0, hjust = 0.5), #Centers axis
        plot.title = element_text(size = 12, hjust = 0.5), #Centers title
        panel.grid.major = element_blank(),  #Removes major grid lines
        panel.grid.minor = element_blank())  #Removes minor grid lines

```

The authors categorised the arrest data from the FBI into three categories. As mentioned earlier in [@sec-data], these categories are violent, property, and drug related crimes. The FBI’s UCR program consists of data from more than 18 000 city, university, college, country, state, tribal, and federal law enforcement agencies. [@fbi_ucr]. According to the UCR program, the categories we mentioned are the crimes most committed by young adults [@fbi_ucr]. They are also the crimes that are most consistently reported by law enforcement agencies [@education]. We have found that criminal justice agencies, law enforcement and social service providers often analyse these crimes, likely due to their volume and data availability.

In analyzing @fig-arrests, we can see a jump in male arrests for ages 15 to 18. The arrests peak at 18 and then fall gradually thereafter. These are the ages individuals are typically meant to be in high school. Within this figure, we can see how arrest rates vary across different age groups. An analysis can tell us the consistency across age cohorts. The types of crime driving the trend, is of particular interest to us. We observed there is an increase in drug-related crimes for individuals in this age range and is more pronounced that the other two types of crimes. It prompts further investigation and we provide some insight to this in [@sec-results].

Note that we examined county level data rather than state level data. This is due to the fact that counties rarely report their data even in a 5 year window. Thus, we focused on one that reported their data and use it to talk about state wide reforms [@education].

```{r}
#| echo: false
#| label: fig-dropout
#| warning: false
#| message: false
#| fig-cap: Change in dropout ages designated by state law between 1980 and 2010

#Rename coloumn for dropout_age
names(dropout_age)[names(dropout_age) == "STATEFP"] <- "bpl"

# Load US state boundary data
us_states <- map_data("state")

#Covert to spatial data frama
maps_d_sf <- st_as_sf(maps_d_clean, coords = c("x_c", "y_c"))

# Filter dropout_age for 1980 and 2010
dropout_age_1980 <- filter(dropout_age, year == 1980)
dropout_age_2010 <- filter(dropout_age, year == 2010)

# Join the datasets mapd_d_sf and dropout_age_1980, as well as dropout_age_2010
maps_d_sf_1980 <- left_join(maps_d_sf, dropout_age_1980, by = c("bpl"))
maps_d_sf_2010 <- left_join(maps_d_sf, dropout_age_2010, by = c("bpl"))

#Convert the coloumn values to contain all lowercase values to match with 
# a us_states column
maps_d_sf_1980$NAME <- tolower(maps_d_sf_1980$NAME)
us_states_1980 <- left_join(us_states, maps_d_sf_1980, 
                            by =  c("region" = "NAME"))

maps_d_sf_2010$NAME <- tolower(maps_d_sf_2010$NAME)
us_states_2010 <- left_join(us_states, maps_d_sf_2010, 
                            by =  c("region" = "NAME"))

# Plots the map boundary
base_map <- ggplot() +
  geom_polygon(data = us_states_1980, aes(x = long, y = lat, group = group), 
               fill ="white", color = "grey") +
  coord_map() +
  theme_minimal() +
  labs(x = "Longitude", y = "Latitude") +
  ggtitle("Map of US States")

#Set the colours for the different ages
colours <- c("14" = "aquamarine2", "15" = "seagreen", "16" = "aquamarine3", 
             "17" = "aquamarine4", "18" = "chartreuse4", "NA" = "white")

# Plot dropout age data within state boundaries
data_map_1980 <- ggplot() +
  geom_sf(data = maps_d_sf_1980, aes(fill = as.factor(dropage)), size = 2) +
  geom_polygon(data = us_states_1980, aes(x = long, y = lat, group = group, 
                                          fill = as.factor(dropage)), 
               color = "grey") +
  theme_void() +
  scale_fill_manual(values = colours, 
                    guide = "legend", name = "Dropout Age  ",
                    na.value = "white") +
  labs(title = "Dropout Age by State (1980)") +
  theme(plot.title = element_text(size = 10, hjust = 0.4),
        legend.title = element_text(size = 10)) +
  coord_sf(xlim = c(-130, -60), ylim = c(25, 50))

# Plot dropout age data within state boundaries
data_map_2010 <- ggplot() +
  geom_sf(data = maps_d_sf_2010, aes(fill = as.factor(dropage)), size = 2) +
  geom_polygon(data = us_states_2010, aes(x = long, y = lat, group = group, 
                                          fill = as.factor(dropage)), 
               color = "grey") +
  theme_void() +
  scale_fill_manual(values = colours, 
                    guide = "legend", name = "Dropout Age  ",
                    na.value = "white") +
  labs(title = "Dropout Age by State (2010)") +
  theme(plot.title = element_text(size = 10, hjust = 0.4),
        legend.title = element_text(size = 10)) +
  coord_sf(xlim = c(-130, -60), ylim = c(25, 50))

# Show the combined plot
figure2 <- grid.arrange(data_map_1980, data_map_2010, ncol = 1)

```

In terms of CSL reforms, @fig-dropout illustrates the age individuals are required to be in school until they can dropout. This dropout age is shown for each state, starting at 14 until 18. Initially, in 1980, there was significant variability among states for the dropout age. 16% of states set the age under 16, 54% of the states set the age at 16 and 26% at ages 17-18. However, by 2010, we saw a notable shift in the mandatory dropout ages. Only one state, Montana, had the dropout age under 16 and 62% of states set the age to be 18. As you can see, there was a significant increase in educational interventions, in the form of CSL reforms, between the years 1980 and 2010. This reflects a broader societal emphasis on the importance of education and its impact on various social outcomes such as crime rates. 

```{r}
#| echo: false
#| label: fig-rates
#| warning: false
#| fig-cap: Prior and post reform crime rates for ages 15-24

# Calculate arrest rates
figure3_data$arrest_rate_base <- exp(figure3_data$base_age)
figure3_data$arrest_rate_new <- exp(figure3_data$base_age + figure3_data$b_age)

# Plotting
# Total
total_fig <- ggplot(figure3_data[figure3_data$crime == 4, ], aes(x = age)) +
  geom_line(aes(y = arrest_rate_base, color = "prior"), stat = "identity", alpha = 1) +
  geom_line(aes(y = arrest_rate_new, color = "post",), stat = "identity", alpha = 1) +
  labs(x = "Age", y = "Estimated Arrest Rates", title = "Total") +
  scale_x_continuous(breaks = seq(15, 24, by = 1)) +
  scale_y_continuous(limits = c(0.04, 0.12), breaks = seq(0.04, 0.12, by = 0.02)) +
  scale_color_manual(name = NULL,
                    values = c("prior" = "aquamarine2", "post" = "chartreuse4"), 
                    labels = c("post", "prior")) + 
  theme_minimal() +
  theme(legend.position = "right",
        plot.title = element_text(size = 11, hjust = 0.5),
        axis.text.x = element_text(angle = 45, size = 6.5),
        axis.text.y = element_text(angle = 45, size = 7),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        panel.grid.major = element_blank())

# Violent
violent_fig <- ggplot(figure3_data[figure3_data$crime == 1, ], aes(x = age)) +
  geom_line(aes(y = arrest_rate_base, color = "prior"), stat = "identity", alpha = 1) +
  geom_line(aes(y = arrest_rate_new, color = "post",), stat = "identity", alpha = 1) +
  labs(x = "Age", y = "Estimated Arrest Rates", title = "Violent") +
  scale_x_continuous(breaks = seq(15, 24, by = 1)) +
  scale_y_continuous(limits = c(0, 0.032), breaks = seq(0, 0.032, by = 0.008)) +
  scale_color_manual(name = NULL,
                     values = c("prior" = "hotpink", "post" = "darkred"), 
                     labels = c("post", "prior")) + 
  theme_minimal() +
  theme(legend.position = "right",
        plot.title = element_text(size = 11, hjust = 0.5),
        axis.text.x = element_text(angle = 45, size = 6.5),
        axis.text.y = element_text(angle = 45, size = 7),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        panel.grid.major = element_blank())

# Property
property_fig <- ggplot(figure3_data[figure3_data$crime == 2, ], aes(x = age)) +
  geom_line(aes(y = arrest_rate_base, color = "prior"), stat = "identity", alpha = 1) +
  geom_line(aes(y = arrest_rate_new, color = "post",), stat = "identity", alpha = 1) +
  labs(x = "Age", y = "Estimated Arrest Rates", title = "Property") +
  scale_x_continuous(breaks = seq(15, 24, by = 1)) +
  scale_y_continuous(limits = c(0, 0.06), breaks = seq(0, 0.06, by = 0.015)) +
  scale_color_manual(name = NULL,
                     values = c("prior" = "deepskyblue", "post" = "blue"), 
                     labels = c("post", "prior")) + 
  theme_minimal() +
  theme(legend.position = "right",
        plot.title = element_text(size = 11, hjust = 0.5),
        axis.text.x = element_text(angle = 45, size = 6.5),
        axis.text.y = element_text(angle = 45, size = 7),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        panel.grid.major = element_blank())

# Drugs
drugs_fig <- ggplot(figure3_data[figure3_data$crime == 3, ], aes(x = age)) +
  geom_line(aes(y = arrest_rate_base, color = "prior"), stat = "identity", alpha = 1) +
  geom_line(aes(y = arrest_rate_new, color = "post",), stat = "identity", alpha = 1) +
  labs(x = "Age", y = "Estimated Arrest Rates", title = "Drugs") +
  scale_x_continuous(breaks = seq(15, 24, by = 1)) +
  scale_y_continuous(limits = c(0, 0.036), breaks = seq(0, 0.036, by = 0.009)) +
  scale_color_manual(name = NULL,
                     values = c("prior" = "gray45", "post" = "black"), 
                     labels = c("post", "prior")) + 
  theme_minimal() +
  theme(legend.position = "right",
        plot.title = element_text(size = 11, hjust = 0.5),
        axis.text.x = element_text(angle = 45, size = 6.5),
        axis.text.y = element_text(angle = 45, size = 7),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        panel.grid.major = element_blank())

# Arrange plots using patchwork
figure3 <- total_fig + violent_fig +
  plot_layout(ncol = 2) +
  property_fig + drugs_fig

# Print the combined plot
print(figure3)
```


# Discussion {#sec-discussion}

\newpage


# References


